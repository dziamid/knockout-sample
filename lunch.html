<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <script type="text/javascript" src="vendor/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="vendor/jquery.tmpl.js"></script>
    <script type="text/javascript" src="vendor/knockout/knockout-latest.debug.js"></script>



    <style type="text/css">
        body {
            font-family: Helvetica, "Helvetica Neue";
            background-color:#528CE0;

        }
        .body {
            background-color: white;
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            padding: 20px 40px;
            margin: 40px;
        }
        .calendar {
            display: table-row;
        }
        .calendar .item {
            display: table-cell;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
        }
        .calendar .item:hover,
        .calendar .item.active {
            background: black;
            color: white;
        }
        .item {
            padding: 10px;
            cursor: pointer;

        }
        .menu {
            display: table;
        }

        .menu .item {
            display: table-row;
        }

        .menu .item span {
            display: table-cell;
            margin-bottom: 5px;
        }


    </style>
</head>
<body>
<div class="body">
    <h3>Calendar</h3>

    <ul class="calendar" data-bind="foreach: menus">
        <li class="item" data-bind="
            text: title,
            click: $root.activateMenu,
            css: {active: $root.isActiveMenu($data)}
            "></li>
    </ul>

    <h3>Menu for <span data-bind="text: activeMenu().title"></span></h3>
    <ul class="menu" data-bind="foreach: activeMenuItems">
        <li class="item">
            <span data-bind="text: title"></span>
        </li>
    </ul>

    <h3>Your order:</h3>
    <ul class="order" data-bind="foreach: orderItems">
        <li class="item">
            <span data-bind="text: amount"></span>
        </li>
    </ul>

</div>

<script type="text/javascript">
    function Menu(id, title) {
        return {
            id: id,
            title: title
        };
    };

    function MenuItem(id, title, menuId) {
        return {
            id: id,
            title: title,
            menuId: menuId
        };
    };

    function OrderItem(menuItem, amount) {
        return {
            menuItem: menuItem,
            amount: amount
        };
    }

    function MenuVM(activeMenuId) {
        var self = this;

        self.menus = ko.observableArray([
            new Menu(1, 'Yesterday'),
            new Menu(2, 'Today'),
            new Menu(3, 'Tomorrow')
        ]);

        self.menuItems = ko.observableArray([
            new MenuItem(1, 'Spagetti', 1),
            new MenuItem(2, 'Makaroni', 1),
            new MenuItem(3, 'Plov', 2),
            new MenuItem(3, 'Super sup', 2),
            new MenuItem(3, 'Govno sup', 3)
        ]);

        self.findMenu = function (id) {
            return ko.utils.arrayFirst(self.menus(), function (menu) {
                return id == menu.id;
            });
        };
        self.findMenuItems = function (menuId) {
            return ko.utils.arrayFilter(self.menuItems(), function (item) {
                return menuId == item.menuId;
            });
        };
        self.activeMenu = ko.observable();
        self.activeMenuItems = ko.observableArray();
        self.activateMenu = function(menu) {
            self.activeMenu(menu);
            self.activeMenuItems(self.findMenuItems(menu.id));
        };
        self.isActiveMenu = function (menu) {
            return menu.id == self.activeMenu().id;
        };

        self.activateMenu(self.findMenu(activeMenuId));

        //order
        self.orderItems = ko.observableArray();
        self.addToOrder = function (menuItem) {
            var newOrder = new OrderItem(menuItem, 1);
            self.orderItems.push(newOrder);
        }

    };

    var viewModel = new MenuVM(2);
    ko.applyBindings(viewModel);

</script>
</body>
</html>